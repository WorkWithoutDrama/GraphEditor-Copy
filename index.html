<!DOCTYPE html>
<html>
<head>
    <title>–†–µ–¥–∞–∫—Ç–æ—Ä –ì—Ä–∞—Ñ–∞</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.23.0/cytoscape.min.js"></script>
    <script src="https://unpkg.com/dagre@0.8.5/dist/dagre.min.js"></script>
    <script src="https://unpkg.com/cytoscape-dagre@2.5.0/cytoscape-dagre.js"></script>
</head>
<body>

    <div class="controls">
        <button id="loadButton" class="primary">–í—ã–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç</button>
        <input type="file" id="fileInput" accept=".json" style="display: none;">
        <button id="saveButton" class="primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–µ–∫—Ç</button>
        <button id="addActionButton">–î–æ–±–∞–≤–∏—Ç—å –î–µ–π—Å—Ç–≤–∏–µ</button>
        <button id="addStateButton">–î–æ–±–∞–≤–∏—Ç—å –û–±—ä–µ–∫—Ç</button>
        <button id="addLinkButton" class="success">+ –°–≤—è–∑—å (1 ‚Üí 2)</button>
        <button id="removeLinkButton" class="danger">- –°–≤—è–∑—å</button>
        <button id="deleteSelectedButton" class="danger">–£–¥–∞–ª–∏—Ç—å (Del)</button>
        <button id="runLayoutButton">–û–±–Ω–æ–≤–∏—Ç—å –∫–æ–º–ø–æ–Ω–æ–≤–∫—É</button>
        <button id="graphManagerButton" class="primary">Graph Manager</button>
        <span class="hint">–°–Ω–∞—á–∞–ª–∞ –∫–ª–∏–∫ –Ω–∞ <b>–ò—Å—Ç–æ—á–Ω–∏–∫</b>, –∑–∞—Ç–µ–º –Ω–∞ <b>–¶–µ–ª—å</b>.</span>
    </div>

    <div class="main-container">
        <div id="cy"></div>

        <div class="resizer" id="resizer"></div>

        <div class="chat-container" id="chatContainer" style="display: none;">
            <div class="chat-header">
                <h3>Graph Manager</h3>
                <div class="chat-header-buttons">
                    <button class="header-btn" id="clearChatBtn" title="–û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é">üóëÔ∏è</button>
                    <button class="close-btn" id="closeChatBtn">√ó</button>
                </div>
            </div>
            <div class="chat-messages" id="chatMessages">
                <div class="message bot-message">
                    –ü—Ä–∏–≤–µ—Ç! –Ø Graph Manager –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–¥–µ–ª–µ–π —Å–∏—Å—Ç–µ–º. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –º–Ω–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ –∏–ª–∏ –æ–ø–∏—Å–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã, –∏ —è —Å–æ–∑–¥–∞–º –≥—Ä–∞—Ñ–æ–≤—É—é –º–æ–¥–µ–ª—å.
                </div>
            </div>
            <div class="chat-input-container">
                <textarea id="chatInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª..."></textarea>
                <div class="chat-actions">
                    <input type="file" id="fileUpload" accept=".txt,.md,.pdf" style="display: none;">
                    <button id="uploadFileBtn" class="secondary">üìé –§–∞–π–ª</button>
                    <button id="sendMessageBtn" class="primary">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤
        (function() {
            if (window.location.protocol === 'file:') {
                console.log('üìÅ –§–∞–π–ª –æ—Ç–∫—Ä—ã—Ç –ª–æ–∫–∞–ª—å–Ω–æ');
                console.log('üí° –î–ª—è —Ä–∞–±–æ—Ç—ã Graph Manager –∑–∞–ø—É—Å—Ç–∏—Ç–µ:');
                console.log('   1. python api.py');
                console.log('   2. node proxy-server.js');
                console.log('   3. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ ./start-full.sh');

                // –ú–æ–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
                setTimeout(() => {
                    const hint = document.querySelector('.hint');
                    if (hint) {
                        hint.innerHTML += ' <span style="color:orange;">(–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä—ã)</span>';
                    }
                }, 1000);
            }
        })();
    </script>

    <script src="graph-manager.js"></script>
    <script src="script.js"></script>
</body>
</html>

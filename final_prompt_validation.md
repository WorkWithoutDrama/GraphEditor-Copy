# Финальная проверка промпта

## Требования из задания:
1. **Находить действие** и список начальных условий (объекты и их состояния), необходимых для выполнения действия
2. **Находить список конечных условий** (объекты и их состояния), наступающих после выполнения действия
3. **Если действия, объекта или его состояния еще нет в модели** - добавлять в JSON
4. **Формировать "model_connections"** соответствующие связи
5. **Отрисовка графа**: действия в прямоугольниках, объект+состояние в овале, стрелки соответствуют "connection_in" (начало) → "connection_out" (конец)

## Проверка текущего промпта в api-fixed-new-structure.py:

### ✅ Выполнено:
1. **Нахождение действия** - "Найди ОДНО основное действие в описании"
2. **Начальные условия** - "Определи список начальных условий (объекты и их состояния)"
3. **Конечные условия** - "Определи список конечных условий (объекты и их состояния)"
4. **Добавление при отсутствии** - "Если действия, объекта или его состояния еще нет в модели - добавь их (принцип 'если нет - добавь')"
5. **Формирование model_connections** - "Сформируй 'model_connections' для связей между действиями и состояниями"
6. **Отрисовка графа**:
   - "Действия отрисовываются в ПРЯМОУГОЛЬНИКАХ"
   - "Объект + состояние отрисовывается в ОВАЛЕ"
   - "Стрелки соответствуют 'connection_out' (источник) → 'connection_in' (цель)"

### ✅ Идентификаторы:
- action_id: "a" + 5 цифр
- object_id: "o" + 5 цифр  
- state_id: "s" + 5 цифр
- Составной ID для состояния: object_id + state_id

### ✅ Пример правильный:
- Начальное состояние → Действие: `connection_out: "o00001s00001" → connection_in: "a00001"`
- Действие → Конечное состояние: `connection_out: "a00001" → connection_in: "o00001s00002"`

## Проверка JSON структуры:

### model_actions:
```json
{
  "model_actions": [
    {
      "action_id": "a12345",
      "action_name": "Название действия",
      "action_links": {"manual": "", "API": "", "UI": ""}
    }
  ]
}
```

### model_objects:
```json
{
  "model_objects": [
    {
      "object_id": "o12345",
      "object_name": "Название объекта",
      "resource_state": [
        {"state_id": "s00000", "state_name": "null"},
        {"state_id": "s12345", "state_name": "состояние объекта"}
      ],
      "object_links": {"manual": "", "API": "", "UI": ""}
    }
  ]
}
```

### model_connections:
```json
{
  "model_connections": [
    {
      "connection_out": "идентификатор_источника",
      "connection_in": "идентификатор_цели"
    }
  ]
}
```

## Проверка файлов отрисовки:

### ✅ script.js содержит:
- `node[type="action"]` - для прямоугольников
- `node[type="state"]` - для овалов
- Логика обработки нового формата JSON
- Составные ID состояний: `obj.object_id + state.state_id`

### ✅ graph-manager.js содержит:
- Процесс обработки ответов API
- Отправка промпта в API

## Итог:
**✅ Промпт соответствует всем требованиям:**
1. Находит действие, начальные и конечные условия
2. Добавляет отсутствующие элементы в модель
3. Формирует правильные связи в model_connections
4. Указывает правила отрисовки графа
5. Использует правильные идентификаторы
6. Пример демонстрирует правильное использование связей

**✅ Система готова к работе с любым ТЗ (exam.txt или другим)**